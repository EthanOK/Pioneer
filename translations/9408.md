
>- 原文链接：https://medium.com/@Posvar/visualizing-the-ethereum-machine-b39875830ded
>- 译者：[AI翻译官](https://learnblockchain.cn/people/19584)，校对：[翻译小组](https://learnblockchain.cn/people/412)
>- 本文永久链接：[learnblockchain.cn/article…](https://learnblockchain.cn/article/9408)
    


![](https://img.learnblockchain.cn/attachments/migrate/1727170288449)

# 自白：

尽管自2017年以来我一直活跃在区块链领域，但直到2024年我才真正深入了解以太坊的工作原理。如果你在2022年问我解释以太坊，我可能会说类似这样的话...

> 以太坊是一个去中心化的计算引擎，促进智能合约的执行——具有不可变条款的自执行合约。它运行在一个去中心化的计算机网络上，通过分布式账本确保透明性和安全性。每隔几秒钟，就会根据所有最近的交易向“链”中添加一个新的数据块，并通过加密技术来保护该链。

听起来很合理——技术上也没错。我会用逻辑但广泛的回答来处理明显的问题——保持在理解的表面。但如果被问到更深入的问题，我在创造清晰度方面的能力将受到限制——例如这样的问题...

*   为什么执行交易需要‘gas’？这些gas去哪了？
*   它具体是如何去中心化的？
*   验证节点和执行节点有什么区别？
*   当发布区块时，我们如何知道验证者是诚实的？
*   等等。

# 目标：

作为在区块链技术日益普及的世界中导航的技术导向专业人士，了解支撑这一数字革命的基础设施至关重要。以太坊作为领先的去中心化平台，将在去中心化金融（DeFi）和数字资产（例如非同质化代币——NFT）的生态系统中发挥越来越重要的作用。本文旨在通过逐步铸造NFT的过程来阐明以太坊的内部工作原理——从初始的“铸造”交易（TX），通过以太坊堆栈的“执行”和“共识”层，到最终确认NFT已被铸造钱包保护。虽然我们这里的重点是铸造NFT，但基本原理和过程在各种基于以太坊的应用中普遍适用，无论是开创新的金融工具，执行复杂的业务逻辑，还是建立数字身份和所有权。

这个领域很复杂，我不是工程师，所以我从不同的角度来处理这个问题。我相信下面的解释和可视化为技术专业人士和区块链新手提供了一个有价值的基础理解，了解这个生态系统是如何运作的。通过分享这些见解，我希望能创造清晰度，甚至激发好奇心，鼓励你深入了解不断发展的去中心化叙事。

_警告：以太坊作为一个开源项目，通过以太坊改进提案（EIP）过程不断发展。目前有许多正在进行的提案，可能会从根本上改变这个生态系统。_

# 可视化：

我们将使用下面的可视化作为我们通过以太坊（L1，或第1层）生态系统逐步旅程的基础：

![](https://img.learnblockchain.cn/attachments/migrate/1727170288453)

虽然有大量不同的以太坊交易过程的视觉解释——但没有一个完全满足我同时看到过程多个维度的需求。大多数图表似乎将以太坊的复杂性强行压缩成线性、从左到右或从上到下的流程，索引单个参与者的视角——这并不代表这个复杂系统的真实性质。通过将过程可视化为一个重复的\[循环\]周期，带有堆叠的层次——这个图表旨在满足那些需要更多视觉深度的人。

推荐：[这里是PDF格式的可视化](https://1drv.ms/b/s!Ak8XhGG9-q-TgZmufGtwkZoZ0WVAsgA?e=Go7not)——你可能会发现将其在第二个屏幕上查看或打印出来以供阅读时参考和做笔记是有帮助的。

> 注意：本文重点介绍以太坊作为“第1层”（L1）技术，这指的是区块链基础设施的基础层。第1层是以太坊协议本身的底层主网络架构。为了简化起见，我不会深入探讨建立在这一基础层之上的“第2层”（L2）解决方案，这些解决方案通过在主以太坊链外处理交易来解决可扩展性和速度问题。

# 第一步：初始铸造交易

![](https://img.learnblockchain.cn/attachments/migrate/1727170288458)

逐步旅程始于由外部拥有账户（EOA）发起的交易。但究竟什么是EOA，它是如何启动铸造NFT的过程的？

## EOAs和钱包——以太坊交易的起点

EOA本质上是你在以太坊领域的个人立足点。它类似于数字领域的银行账户，但功能更强大。它由一个私钥控制——将其视为你曾经拥有的最安全的密码。这个密钥是你的个人签名，是你加密安全地说“是的，确实是我在发送这笔交易”的方式。

钱包则是界面——管理你EOAs的可信工具。你的钱包保存你的密钥，执行你的命令，并代表你与以太坊区块链互动。

钱包则是界面——管理你EOAs的可信工具。你的钱包保护你的私钥，执行你的命令，并代表你与以太坊区块链互动。每个钱包都与一个用于交易的公共地址相关联，类似于电子邮件地址用于发送和接收消息。这个公共地址是一个以‘0x’开头的42字符十六进制字符串——类似于这样：

> 0`x124f681646d4b755815f9cb19c1acc8565a0c2ac`

这种地址格式允许数百万种独特的组合，确保每个用户的地址在以太坊网络上是独特且安全的。

## 交易中的安全性——签名的作用

那么，你如何安全地发送交易？我们如何防止其他人代表你行动？答案在于数字签名。当你发送交易时，你的钱包使用你的私钥对其进行加密签名。这个签名可以通过你的公钥——你的EOA地址进行验证——确保只有来自你钱包的交易才能真正来自你。

## 交易中的数据——用操作码编码意图

当你通过钱包决定铸造NFT时，你创建了一个交易（TX）。这不仅仅是任何数据包——它是一个意图的捆绑包，包含操作码（OpCodes），指示以太坊虚拟机（EVM）需要执行的一系列操作。这些操作码是以太坊的语言；它们告诉智能合约该做什么，无论是创建代币，转移以太币，还是在我们的例子中，铸造NFT（关于智能合约和EVM的更多内容将在后续部分中介绍）。

## 内存池——以太坊世界的社区邮箱

那么，这笔交易去哪了？进入内存池，以太坊的交易等待室。它有点像一个社区邮箱；你已经发送了你的信件，但它不会直接到达收件人。相反，它等待一个邮件分类员（执行节点）来拾取它，组织它，然后传递给邮递员（验证者）将其送到最终目的地（区块链）。我们很快会更详细地介绍这些步骤。在几个步骤中，我们将看到这笔交易如何最终从内存池中被选中、打包，并通过以太坊虚拟机（EVM）执行——但首先，我们需要介绍验证者网络的概念。

# 第2步：随机验证者选择

![](https://img.learnblockchain.cn/attachments/migrate/1727170288459)

每12秒，以太坊网络内会掷一次数字骰子，这个过程决定了哪个验证者有荣幸（和奖励）提议下一个要添加到区块链的交易区块。这不仅仅是一个机会游戏；它是网络安全性和去中心化的关键组成部分，由称为RANDAO算法的随机信标决定。

## RANDAO信标——确保公平竞争

想象一下RANDAO是一个不可腐败的彩票系统。它利用网络中每个验证者的集体承诺，结合他们的输入生成一个既不可预测又安全的随机数。这确保了没有单个验证者可以操纵系统以获得优势，体现了公平参与的精神。

## 验证者——以太坊信任的支柱

验证者是以太坊区块链的哨兵，他们将自己的ETH（32 ETH——或当前价值约10万美元）作为抵押参与网络。任何人都可以通过质押所需的ETH并运行开源验证者节点软件（例如GETH）成为验证者。质押的ETH既是进入验证者池的钥匙，也是激励诚实参与的保证金（如果验证者被证明有恶意行为，他们的质押将被“削减”——或烧毁）。验证者执行各种角色，从提议区块到证明其他区块的有效性，使他们对维护账本的完整性至关重要。

## 验证者网络——去中心化的守护者

区块提议者的选择（每12秒）是以太坊区块链生命周期中的一个关键事件。随着成千上万的验证者分布在全球各地，以太坊网络确保没有单个实体可以施加过多的影响。这个去中心化的验证者网络保护区块链免受欺诈和操纵，同时坚持透明和集体协议的原则。

让我们继续验证者在第3步中的第一个责任。

# 第3步：建立父状态

![](https://img.learnblockchain.cn/attachments/migrate/1727170288498)

在以太坊的交易处理中，有一条贯穿每个区块的连续线程，连接过去、现在和未来。第3步是选定的验证者接过提议新区块的接力棒，从链中检索最后一个区块。这是一个关键步骤：为下一个要构建的区块建立“父状态”。

## 最后一个区块——下一个区块的基础

将区块链视为一个祖先记录，每个区块都是前一个区块的继承者。验证者调用最后一个区块作为父区块——新区块将建立在其基础上。这个父区块是最近达成共识的区块链状态，包含最新的状态转换和对其自身父区块的引用。这形成了一条区块链，当追溯到创世区块时，累积代表了区块链的完整历史。

## 为什么父状态很重要

通过拉取最后一个区块，验证者不仅仅是在获取数据；他们是在承认和维护整个区块链的历史。这确保了连续性和完整性，确保每笔交易都建立在经过验证的真相基础上。

在建立了父状态后，现在是时候构建下一个区块了。在今天的以太坊生态系统中，验证者通常不会构建区块——这是执行节点（也称为搜索者和区块构建者）的角色，我们将在接下来探讨。

# 第4步：交易选择与排序

![](https://img.learnblockchain.cn/attachments/migrate/1727170289586)

在验证者建立了父状态后，接力棒交给了执行节点——这些工作马选择/处理交易并构建区块。验证者和执行节点之间的角色分离加强了以太坊的去中心化性质。不同的参与者带来了他们的资源——一些通过质押ETH进行验证，另一些通过提供计算能力来执行和构建区块。这是一种共生关系，确保没有单个参与者拥有过多的权力，并且区块链平稳有效地运行。

## 执行节点——挑剔的策展人

执行节点筛选内存池中的交易（回想一下——这些是第1步中的候选交易），选择哪些将包含在下一个区块中。他们的标准是多方面的：他们考虑交易费用（gas价格）、复杂性、nonce——特定账户操作序列中的交易位置——以及交易之间的依赖关系。

## 排序——编织交易的叙述

交易的排序是一种艺术形式。每笔交易都包含一个nonce，确保所有特定账户的交易相对于该账户的其他交易按顺序处理（例如，如果我的钱包向内存池发送3笔交易，执行节点必须根据它们的nonce对这些交易进行排序）。执行节点使用这些nonce以及gas价格来决定操作顺序。高gas价格可以像快速通道一样，将交易移到队列前面，因为它们承诺更高的处理奖励。这创造了一个动态市场，用户可以调整他们提供的费用以影响他们的交易从内存池中被拾取的速度。

_注意：如果用户在交易中设置的gas价格过低，他们面临交易在内存池中滞留的风险，可能永远不会被执行节点拾取。因此，用户评估网络活动并设置适当的gas价格以确保他们的交易及时执行是至关重要的（钱包通常会为用户自动化这一过程）。_

## 价值提取——执行节点的激励

执行节点被激励进行这种仔细的选择和排序；他们通过交易费用提取价值。这个提取价值的过程通过_矿工可提取价值_（MEV）的概念进一步细化，指的是执行节点通过战略性排序、包含或排除交易可以实现的额外利润。MEV的产生是因为以太坊网络上的交易在确认之前可以在内存池中公开看到，允许执行节点优先处理或抢先处理某些提供更高财务回报的交易。虽然验证者因将区块添加到链中而获得报酬，执行节点则通过他们处理的交易的gas费用和潜在的MEV机会来赚取报酬。这不仅奖励了他们的计算工作，还使他们的利益与网络的效率和安全性保持一致。

尽管MEV可能带来复杂的伦理和公平性挑战，但以太坊社区承认这是区块链去中心化性质的一部分。MEV的持续透明性和竞争性可以导致更高效的市场动态和更好的网络安全。此外，以太坊社区正在积极参与讨论和开发工作，以减轻MEV的潜在负面影响，确保网络对所有用户保持公平和安全。## 执行的前奏 — 为 EVM 做准备

在策划和排序了一批交易后，执行节点将在下一步通过以太坊虚拟机（EVM）执行这些交易。

# 第五步：通过以太坊虚拟机（EVM）执行

![](https://img.learnblockchain.cn/attachments/migrate/1727170289618)

这是理论在以太坊区块链上变为现实的地方。在这里，执行节点精心排序的交易将根据智能合约的确定性进行处理，从而构建并广播一个包含新状态变化的提议区块。

## 确定性代码 — 执行的坚定路径

在计算中，确定性是信任和可预测性的基石。确定性代码的定义是，给定特定输入，总是会产生相同的输出（在计算器上2+2总是等于4）。在以太坊生态系统中，这确保了智能合约——用代码编写的自操作协议——能够不折不扣地执行其条款。没有猜测或解释的余地；EVM 以不变的精度执行智能合约代码。

## 智能合约 — 以太坊的自治代理

智能合约是以太坊的自治代理，驻留在区块链上，等待被调用时执行其代码。它们是现实世界中合同的数字等价物，但不需要中介。智能合约定义规则并在交易执行时自动执行这些规则。这是一场协议执行的革命，超越了传统的法律和地理界限。

一个合适（尽管不完美）的智能合约类比是将其与老式自动售货机进行比较——机器本质上是根据规则机械地向买家交付产品。例如，如果以下条件为真：

> 电源开启（AND）“B7”槽中的产品有库存（AND）机器处于工作状态

并且你按如下操作：

> 你投入所需数量的硬币（AND）硬币是真实的（AND）你按下“B7”

……那么自动售货机将交付B7槽中的请求产品。交易不能被中间人审查（没有衬衫，没有鞋子？没问题）。当然，在实践中，我们可能都遇到过自动售货机故障、需要轻推才能完全掉下产品或没有找零的情况。这是一个不完美的类比，因为自动售货机并非完全依赖代码运行（存在机器无法控制的现实世界依赖），这意味着产品交付实际上并非100%确定性。与此同时，智能合约严格在其代码设定的参数内运行，消除了人为错误和偏见，从而提供了一种更可靠和透明的方法来执行数字领域的合同协议。

## 利用父状态 — 状态变化的基础

我们在第三步中讨论的父状态作为新一批交易的EVM输入。在我们的NFT示例中——如果我正在从一个10K NFT的集合中铸造一个NFT——EVM需要验证，例如，合同中是否还有可铸造的NFT。它通过父状态验证这个余额。如果父状态显示仅剩3个NFT，而有5个不同的钱包尝试铸造——第四步中的交易排序对于确定哪3个钱包成功铸造，哪2个钱包交易失败至关重要。对于每个顺序执行的交易，智能合约读取当前状态，执行其编码操作，并提出更新——通常更改账户余额或其他智能合约的状态。

结果是一组以提议区块形式的状态变化提议，这是所有执行交易后果的计算记录。这些状态变化不是随意的；它们是智能合约中规定的确定性规则的直接结果——如果其他执行节点的交易选择和排序（第四步）相同，它们也会得出相同的提议状态。但这其中有细微差别——成千上万的执行节点在并行操作——竞争构建下一个区块，希望验证者选择他们的区块添加到区块链中。在下一步中，我们将看到验证者如何从众多执行节点提议的区块中选择一个提议区块。

# 第六步：验证者选择区块

![](https://img.learnblockchain.cn/attachments/migrate/1727170289679)

通过EVM执行交易后，现在由验证者选择一个提议区块并将其广播到网络。

## 区块选择背后的激励

持有区块提议责任的验证者不仅仅是执行客户端建议的被动接收者。他们有权选择提议哪个区块——他们的决定并非没有私利。验证者的收入来自两种形式的区块奖励：

1.  作为补偿他们在验证交易和维护区块链过程中消耗的能源和资源的固定数量的ETH
2.  用户为将其交易包含在区块中而支付的一部分“gas”

因此，验证者有经济动机选择能够最大化其回报的区块，而不损害网络的规则和可靠性。

## 对执行节点和验证者的好处

这个选择过程不仅仅是验证者填满自己的口袋；它是保持网络强健和参与者诚实的更大经济舞蹈的一部分。执行节点也受益，因为他们在处理和提议区块中的计算努力通过交易费用得到回报——只有当验证者选择了他们提议的区块时，这些费用才会被收集。因此，存在一种共生关系：执行节点努力创建有价值的区块，而验证者则选择能够维持网络经济和安全标准的区块。

## 系统中的公平性

对旁观者来说，验证者似乎拥有显著的权力，可能倾向于不公平。然而，RandDAO算法在验证者选择中的作用（回想第二步）是伟大的平衡器。它确保没有单个验证者能够持续控制区块选择，从而防止任何长期的战略操纵。验证者选择中的这种随机性是以太坊安全性的关键，确保尽管个别验证者出于自利行事，但集体上，他们服务于网络的健康和去中心化。

在选择了提议区块后，验证者现在必须将其广播到更广泛的验证者网络。

# 第七步：验证者网络的区块认证

![](https://img.learnblockchain.cn/attachments/migrate/1727170289719)

一旦验证者做出选择并广播一个提议区块，第七步就展开了验证者网络的关键审查。在这里，个别验证者（所有未被RandDAO选为当前区块提议者的其他验证者）作为陪审员，审查提议区块以确保其完整性和遵守以太坊的规则。

## 认证：验证者的认可印章网络中的验证者现在参与一个称为证明的过程。他们审查提议区块的交易和状态变化，并根据区块链的历史和当前规则进行检查。当一个验证者对一个区块进行证明时，他们实际上是在说：“我已经检查过了，这符合我们作为一个网络所达成的共识。”这与学术出版中的同行评审类似，每篇论文在发表前都要经过严格审查。

## 不只是形式

这不仅仅是走过场。请记住，验证者将自己的ETH作为诚实参与的保证金。如果他们对一个欺诈或错误的区块进行证明，他们将面临失去部分保证金的风险——这一过程称为削减。这种风险是保持验证者诚实的激励结构的尖端。

## 分布式审查以实现分布式信任

每个验证者独立操作，这意味着提议的区块要经过多次并行验证。这种分布式审查在去中心化系统中至关重要。这意味着对区块有效性的信任不依赖于单一实体，而是集体共识的结果。

## 为最终性做准备

虽然第7步不是关于区块的最终确定（这是共识机制的下一步），但它是一个准备阶段。验证者的证明向网络表明，提议的区块已准备好进入验证的最后阶段。这是网络集体智慧被利用来维护区块链完整性的时刻，然后区块被最终确定并添加到链中。

# 第8步：区块最终性和新状态

![](https://img.learnblockchain.cn/attachments/migrate/1727170290326)

这是提议的区块经过验证的考验后达到最终性的时刻。这是以太坊网络集体同意一个区块有效并应不可撤销地添加到区块链中的时刻。

## 共识机制：网络的协议

共识机制是以太坊让所有验证者就区块链状态达成一致的方法。这不仅仅是多数规则；它是一个复杂的算法，确保所有参与的验证者在区块链的最新验证状态上保持同步。当一个区块达到最终性时，这意味着网络已经达成足够的共识，认为该区块不能再被更改或移除——它成为链中不可变的一部分。

## 区块最终性：历史的封印

最终性类似于封存时间胶囊。一旦封闭，它就不能再打开；它包含的历史被永久固定。在区块链的背景下，最终性意味着区块内的所有交易现在都是历史账本的一部分，其结果固定，其状态变化不可更改。对于用户和智能合约来说，这保证了交易不能被逆转，确保了网络的安全性和信任。

随着区块的最终确定，一个新的状态诞生了。这不仅仅是一次更新；这是区块链的下一次进化。所有账户、智能合约和余额现在都更新以反映最新的交易。这个新状态将作为后续交易和区块的父状态，被引用为以太坊网络的真实基础。可视化展示了区块链过程的这种持续、循环性质，反映了一个系统，其中每个区块既是一个结论，也是以太坊不可变账本中的一个新起点。

# 第9步：所有权的实现

![](https://img.learnblockchain.cn/attachments/migrate/1727170290563)

第9步标志着一个复杂旅程的结束，从意图（初始交易）到不可变性，区块链的新状态反映了发起者钱包中的NFT。

## 新状态：更新的数字账本

现在成为以太坊区块链一部分的新状态，包含了更新的余额和最新的变化——包括新铸造的NFT。区块链不仅记录了NFT的存在；它还将NFT的所有权铭刻在发起铸造交易的用户的钱包中。对于用户来说，这是实现的时刻。他们的钱包与以太坊区块链的最新状态同步，现在显示新的NFT。

# 结语：旅程继续

对于以太坊来说，旅程从未真正结束。每个新的最终状态区块只是下一系列交易的起点。随着以太坊的发展，正在进行的升级和提案可能会重塑格局，但它所铭刻的去中心化、透明和安全的核心原则依然坚定不移。这些基础概念确保无论技术如何适应或发展，区块链的完整性和可信度都得以维持。

对于专业人士和新手，爱好者和怀疑者来说，这次探索是一个开放的邀请，继续了解区块链技术的世界。随着物理世界和数字世界的界限日益交融，理解推动以太坊生态系统中各方的基本动机和激励机制，对于任何希望在将定义我们未来的数字景观中产生重大影响的人来说都是至关重要的。除交易可以实现的额外利润。MEV 的产生是因为以太坊网络上的交易在确认之前可以在内存池中公开看到，允许执行节点优先处理或抢先处理某些提供更高财务回报的交易。虽然验证者因将区块添加到链中而获得报酬，执行节点则通过他们处理的交易的 gas 费用和潜在的 MEV 机会来赚取报酬。这不仅奖励了他们的计算工作，还使他们的利益与网络的效率和安全性保持一致。

尽管 MEV 可能带来复杂的伦理和公平性挑战，但以太坊社区承认这是区块链去中心化性质的一部分。MEV 的持续透明性和竞争性可以导致更高效的市场动态和更好的网络安全。此外，以太坊社区正在积极参与讨论和开发工作，以减轻 MEV 的潜在负面影响，确保网络对所有用户保持公平和安全。
## 执行的前奏 — 为 EVM 做准备

在策划和排序了一批交易后，执行节点将在下一步通过以太坊虚拟机（EVM）执行这些交易。

# 第五步：通过以太坊虚拟机（EVM）执行

![](https://img.learnblockchain.cn/attachments/migrate/1727170289618)

这是理论在以太坊区块链上变为现实的地方。在这里，执行节点精心排序的交易将根据智能合约的确定性进行处理，从而构建并广播一个包含新状态变化的提议区块。

## 确定性代码 — 执行的坚定路径

在计算中，确定性是信任和可预测性的基石。确定性代码的定义是，给定特定输入，总是会产生相同的输出（在计算器上 2+2 总是等于 4）。在以太坊生态系统中，这确保了智能合约——用代码编写的自操作协议——能够不折不扣地执行其条款。没有猜测或解释的余地；EVM 以不变的精度执行智能合约代码。

## 智能合约 — 以太坊的自治代理

智能合约是以太坊的自治代理，驻留在区块链上，等待被调用时执行其代码。它们是现实世界中合同的数字等价物，但不需要中介。智能合约定义规则并在交易执行时自动执行它们。这是一场协议执行的革命，超越了传统的法律和地理界限。

一个合适（尽管不完美）的智能合约类比是将其比作一个老式自动售货机——机器本质上是根据规则机械地向买家交付产品。例如，如果以下条件为真：

> 电源开启（AND）“B7”槽中的产品有库存（AND）机器处于工作状态

并且你按如下操作：

> 你投入所需数量的硬币（AND）硬币是真实的（AND）你按下“B7”

……那么自动售货机将交付 B7 槽中的请求产品。交易不能被中间人审查（没有衬衫，没有鞋子？没问题）。当然，在实践中，我们可能都遇到过自动售货机故障、需要轻推才能完全掉下产品或没有找零正确的情况。这是一个不完美的类比，因为自动售货机并非完全依赖代码运行（存在机器无法控制的现实世界依赖），这意味着产品交付实际上并非 100%确定性。与此同时，智能合约严格在其代码设定的参数内运行，消除了人为错误和偏见，从而提供了一种更可靠和透明的方法来执行数字领域的合同协议。

## 利用父状态 — 状态变化的基础

我们在第三步中讨论的父状态作为 EVM 处理新一批交易的输入。在我们的 NFT 示例中——如果我正在从一个包含 10K 个 NFT 的集合中铸造一个 NFT——EVM 需要验证，例如，合约中是否还有可铸造的 NFT。它通过父状态验证这个余额。如果父状态显示仅剩 3 个 NFT，而有 5 个不同的钱包尝试铸造——第四步中的交易排序对于确定哪 3 个钱包成功铸造，哪 2 个钱包交易失败至关重要。对于每个顺序执行的交易，智能合约读取当前状态，执行其编码操作，并提出更新——通常更改账户余额或其他智能合约的状态。

结果是一组以提议区块形式的状态变化提议，这是所有执行交易后果的计算记录。这些状态变化不是随意的；它们是智能合约中规定的确定性规则的直接结果——如果其他执行节点的交易选择和排序（第四步）相同，它们也会得出相同的提议状态。但这其中有细微差别——成千上万的执行节点在并行操作——竞争构建下一个区块，希望验证者选择他们的区块添加到区块链中。在下一步中，我们将看到验证者如何从众多执行节点提议的区块中选择一个提议区块。

# 第六步：验证者选择区块

![](https://img.learnblockchain.cn/attachments/migrate/1727170289679)

通过 EVM 执行交易后，现在由验证者选择一个提议区块并将其广播到网络。

## 区块选择背后的激励

持有区块提议责任的验证者不仅仅是执行客户端建议的被动接收者。他们有权选择提议哪个区块——他们的决定并非没有私利。验证者的收入来自两种形式的区块奖励：

1.  一定数量的 ETH，作为他们在验证交易和维护区块链过程中消耗的能源和资源的补偿
2.  用户为将其交易包含在区块中而支付的一部分“gas”

因此，验证者有经济动机选择能最大化其回报的区块，同时不损害网络的规则和可靠性。

## 对执行节点和验证者的好处

这个选择过程不仅仅是验证者填满自己的口袋；它是保持网络强健和参与者诚实的更大经济舞蹈的一部分。执行节点也受益，因为他们在处理和提议区块中的计算努力通过交易费用得到回报——只有当验证者选择了他们提议的区块时，这些费用才会被收集。因此，存在一种共生关系：执行节点努力创建有价值的区块，而验证者则选择能维持网络经济和安全标准的区块。

## 系统中的公平性

对旁观者来说，验证者似乎拥有显著的权力，可能倾向于不公平。然而，RandDAO 算法在验证者选择中的作用（回想第二步）是伟大的平衡器。它确保没有单个验证者能够持续控制区块选择，从而防止任何长期的战略操纵。验证者选择中的这种随机性是以太坊安全性的关键，确保尽管个别验证者出于私利行事，但集体上，他们服务于网络的健康和去中心化。

在选择了提议区块后，验证者现在必须将其广播到更广泛的验证者网络。

# 第七步：验证者网络的区块认证

![](https://img.learnblockchain.cn/attachments/migrate/1727170289719)

一旦验证者做出选择并广播一个提议区块，第七步就展开了验证者网络的关键审查。这是其他验证者（所有未被 RandDAO 选为当前区块提议者的验证者）作为陪审员，审查提议区块以确保其完整性和遵守以太坊规则的地方。

## 认证：验证者的认可印章
网络中的验证者现在参与一个称为证明的过程。他们审查提议区块的交易和状态变化，并根据区块链的历史和当前规则进行检查。当一个验证者对一个区块进行证明时，他们实际上是在说：“我已经检查过了，这符合我们作为一个网络所达成的共识。”这与学术出版中的同行评审类似，每篇论文在发表前都要经过严格的审查。

## 不只是形式

这不仅仅是走过场。请记住，验证者将自己的 ETH 作为诚实参与的保证金。如果他们对一个欺诈或错误的区块进行证明，他们将面临失去部分保证金的风险——这一过程称为削减。这种风险是保持验证者诚实的激励结构的尖端。

## 分布式审查以实现分布式信任

每个验证者独立操作，这意味着提议的区块会受到多次并行验证。这种分布式审查在去中心化系统中至关重要。这意味着对区块有效性的信任不依赖于单一实体，而是集体共识的结果。

## 为最终性做准备

虽然第 7 步不是区块最终化（这是共识机制中的下一步），但它是一个准备阶段。验证者的证明向网络表明，提议的区块已准备好进入验证的最后阶段。这是网络集体智慧被利用来维护区块链完整性的时刻，区块在最终化并添加到链中之前。

# 第 8 步：区块最终性和新状态

![](https://img.learnblockchain.cn/attachments/migrate/1727170290326)

这是提议的区块经过验证的考验后达到最终性的时刻。这是以太坊网络集体同意区块有效并应不可撤销地添加到区块链中的时刻。

## 共识机制：网络的协议

共识机制是以太坊让所有验证者就区块链状态达成一致的方法。这不仅仅是多数规则；它是一个复杂的算法，确保所有参与的验证者在区块链的最新验证状态上保持同步。当一个区块达到最终性时，这意味着网络已经达成足够的共识，区块不能再被更改或移除——它成为链中不可变的一部分。

## 区块最终性：历史的封印

最终性类似于封存时间胶囊。一旦封闭，就不能再打开；它包含的历史被永久固定。在区块链的背景下，最终性意味着区块内的所有交易现在都是历史账本的一部分，其结果固定，其状态变化不可更改。对于用户和智能合约来说，这保证了交易不能被逆转，确保了网络的安全性和信任。

随着区块的最终化，一个新状态诞生了。这不仅仅是一次更新；这是区块链的下一次进化。所有账户、智能合约和余额现在都更新以反映最新的交易。这个新状态将作为后续交易和区块的父状态，被引用为以太坊网络的真实基础。可视化展示了区块链过程的这种持续、循环性质，反映了一个系统，其中每个区块既是一个结论，也是以太坊不可变账本中的一个新起点。

# 第 9 步：所有权的实现

![](https://img.learnblockchain.cn/attachments/migrate/1727170290563)

第 9 步标志着一个复杂旅程的结束，从意图（初始交易）到不可变性，区块链的新状态反映了发起者钱包中的 NFT。

## 新状态：更新的数字账本

现在成为以太坊区块链一部分的新状态，包含了更新的余额和最新的变化——包括新铸造的 NFT。区块链不仅记录了 NFT 的存在；它还将 NFT 的所有权铭刻在发起铸造交易的用户的钱包中。对于用户来说，这是实现的时刻。他们的钱包与以太坊区块链的最新状态同步，现在显示新的 NFT。

# 结语：旅程继续

对于以太坊来说，旅程从未真正结束。每个新的最终状态区块只是下一系列交易的起点。随着以太坊的发展，升级和提案可能会重塑格局，但它所铭刻的去中心化、透明和安全的核心原则依然坚定不移。这些基础概念确保无论技术如何适应或增长，区块链的完整性和可信度都得以维持。

对于专业人士和新手，爱好者和怀疑者来说，这次探索是一个开放的邀请，继续了解区块链技术的世界。随着物理世界和数字世界的边界日益交汇，理解驱动以太坊生态系统中各方的基本动机和激励，对于任何希望在定义我们未来的数字景观中产生重大影响的人来说都是至关重要的。

> 我是 [AI 翻译官](https://learnblockchain.cn/people/19584)，为大家转译优秀英文文章，如有翻译不通的地方，在[这里](https://github.com/lbc-team/Pioneer/blob/master/translations/9408.md)修改，还请包涵～