
>- 原文链接：https://blog.oxor.io/lido-decoded-a-deep-dive-into-ethereums-liquid-staking-solution-40a749bab56d
>- 译者：[AI翻译官](https://learnblockchain.cn/people/19584)
>- 本文永久链接：[learnblockchain.cn/article…](https://learnblockchain.cn/article/8493)
    
![img](https://img.learnblockchain.cn/attachments/migrate/1719323916543)

> 探索 Lido 的旅程，这个关键角色正在重塑以太坊的质押。本文将带你从 Lido 的早期开始，穿越以太坊质押的复杂性，到 Lido 提供的创新解决方案。

# 介绍

> 本文讨论了由 Vasilii Shapovalov、Konstantin Lomashuk 和一群经验丰富的开发人员于 2020 年 12 月创立的 Lido 项目的历史，该项目在过去两年中在 TVL 方面表现出令人印象深刻的增长。

2020 年，Lido 通过引入其金融衍生品 stETH，有效地创建了流动质押行业，从而产生了重大影响。在协议的第一个版本中，stETH 使存款合约中质押的资金变得流动，在第二个版本中，它甚至允许通过返还 ETH 和销毁 stETH 来提取存款。

以太坊的原生质押与信标链的启动同时出现，这标志着从工作量证明（PoW）到权益证明（PoS）的逐步过渡的开始。最初，质押是一种单向操作，涉及与存款合约的交互。质押后，在激活 The Merge 更新之前，无法从存款合约中提取资金，该更新引入了验证者自愿和强制退出的逻辑。这一限制突显了需要一个新方向来解决无法取消质押和使用资金的问题，从而催生了流动质押。

Lido 在其协议的第一个版本中创建的内容使他们成为流动质押的先驱，这一概念自协议诞生以来开始获得动力。在 Lido 之前，这一领域没有可靠且高质量的代表。

Lido 提供了交易所股票、自我质押和其他限制性和去中心化协议的替代方案。如果验证者因不当行为被取消资格，就有可能丢失或错过奖励。例如，这可能是由于验证者节点代码中的错误或连接问题导致的。这种风险使得在以太坊上质押在初期阶段特别没有吸引力，因为对于一个平均奖励，参与者必须承担市场风险而无法拒绝质押。

为了使质押的资金变得流动，协议引入了一种代币衍生品 stETH，使用户的资金可以在其他协议中解冻和重复使用。这些衍生品今天仍以 1:1 的质押与衍生品比例发行。

在这一系列文章中，我们将引导你了解 Lido 协议发展的整个过程。我们旨在揭示 Lido 如何适应以太坊的变化以及它为用户提供的机会。我们还将深入探讨协议本身的机制，用简单的术语描述其架构和操作原理的复杂方面。

但在深入探讨协议本身之前，我们应该简要回顾一下以太坊生态系统更新的历史。

> 作为对 Lido 链上和链下组件审计的一部分，我们的审计团队彻底检查了项目的架构和功能。在这一系列文章中，我们将逐步增加所讨论概念的复杂性，确保你不会错过任何内容，并能完全理解所有重要细节。**我们邀请你与我们一起深入探讨！**

# 简要回顾以太坊的历史

> 在本节中，我们将简要讨论塑造 Lido 所解决问题的以太坊协议的关键更新。这也很重要，因为这些更新显著影响了 Lido V2 中的更改。

2020 年 9 月，以太坊开始从工作量证明（PoW）向权益证明（PoS）共识协议过渡，被视为一种更快、更安全和更节能的替代方案。这一过程的高潮是通过采用 [EIP-3675](https://eips.ethereum.org/EIPS/eip-3675) 于 2020 年 12 月 1 日启动的**信标链**，它最初是与主网并行运行的独立区块链。在 2021 年和 2022 年期间，其架构进行了增强和改进。PoS 的过渡始于信标链的启动，要求验证者在存款合约中质押 32 ETH 的倍数。

![img](https://img.learnblockchain.cn/attachments/migrate/1719323916549)

这一发展为以太坊的关键事件**The Merge**奠定了基础，该事件发生在 2022 年 9 月 15 日。

📢 https://twitter.com/VitalikButerin/status/1570306185391378434?s=20

这一更新的激活导致了两条链的最终合并和以太坊 PoW 硬分叉（其代币为 WETH）的分离，该硬分叉成为一个独立项目，并最近宣布解散。该协议完全实现了添加和删除验证者的能力，但自信标链诞生以来存在的问题并未得到解决。这些问题继续对许多潜在的网络参与者构成障碍。

> 现在让我们来看看这些问题，并深入探讨它们的本质。

# 以太坊原生质押的缺点

> 在本节中，我们将提供有理有据的答案，解释为什么信标链中原生验证者的启动是不完美的，并突出使 Lido 服务极其相关的主要问题。

首先，让我们定义质押是一种在持有某些加密货币的同时赚取奖励的方式。你的加密货币在质押时赚取奖励的原因是区块链将其投入工作。允许质押的加密货币使用一种称为权益证明的“共识机制”，这是它们确保所有交易在没有银行或支付处理器介入的情况下得到验证和保护的方式。如果你选择质押你的加密货币，它将成为该过程的一部分。

如前所述，信标链的集成首次允许用户质押他们的 ETH。然而，仍然存在一些问题：

1. **无法提取质押:** 存款后，用户无法从信标链的存款合约中提取质押，直到 The Merge 激活。这使得质押在许多个月内成为一种单向操作。此外，即使在 The Merge 之后，只有大约 43%的验证者可以提取，因为只有以`**0x01**`前缀开头的地址可以指定一个钱包进行最终关闭存款。因此，对于许多人来说，原生质押仍然是一种单向操作。更糟糕的是，在此期间，即使是奖励也无法提取，导致验证者必须在没有即时补偿的情况下工作，依赖于未来累积的延迟奖励。
2. **流动性不足:** 在质押期间，用户无法移动、交易或将他们的 ETH 用作 DeFi 中的抵押品。这在他们能够从信标链中提取资金之前尤其昂贵。
3. **高参与费用:** 用户只能质押 32 ETH 的倍数，这排除了余额较小或不规则的用户。
4. **运营成本:** 尽管以太坊的核心开发人员认识到质押的低硬件和正常运行时间要求，许多用户仍然更愿意提供资本并将运营工作外包给第三方，这对去中心化产生了负面影响。

这是一个将质押提升到新发展水平的重要机会。无论是中心化交易所（最初是信标链启动的主要受益者）还是去中心化质押协议都无法解决这些问题。> 现在让我们仔细看看 Lido 协议为世界提供的解决方案，并简要了解其创建历史。

# Lido — 一个去中心化的解决方案

> 在本节中，我们将帮助你了解 Lido 项目是如何构思和开发的，背后是谁，以及 Lido 解决方案的关键特性。

该项目在**2020 年 12 月**筹集了**200 万美元**。Semantic Ventures、ParaFi Capital、Terra、Snakefish、Betting Facilities、MakerDAO 创始人 Rune Christensen、Aave CEO Stani Kulechov 和 Synthetix 创始人 Kain Warwick 是其中的投资者。

随后，Paradigm 基金向 Lido 投资了 15,120 ETH，获得了 7000 万 LDO。该投资通过 DAO 投票批准。Andreessen Horowitz 在**2022 年 3 月**向该服务贡献了 7000 万美元。

ETH 是通过 Lido 进行流动质押的首个加密货币。后来，支持 Solana (SOL)、Kusama (KSM)、Polygon (MATIC)和 Polkadot (DOT)也相继出现。

该项目的主要优势之一是 Lido 接受任何规模的存款，返还 stETH，显著降低了 32 ETH 的入门门槛。

stETH 与 DeFi 领域的去中心化应用兼容，为用户提供了额外的收入来源。代币可以投资于流动性池，用作贷款的抵押品，并在公开市场上出售。该代币极其流动。**它是 Ethereum 1.0 和 Ethereum 2.0 之间的链接。**

大型验证者从质押服务中获得资金。收入每日分配给 stETH 持有者。这会导致用户余额的变化，考虑到奖励和惩罚。

Lido 对所有收入收取 10%的佣金。一旦 Beacon Chain 网络上的交易开始，用户将收到其投资的 ETH 和奖励。同时，stETH 代币将被清算。然后，收取的费用将分配给验证者（因为他们需要为其技术操作的专业知识获得补偿）和协议的金库。

这种衍生品在流动质押市场中牢牢占据首位，远远领先于第二和第三名。作为领先的去中心化流动质押协议，Lido 控制着超过 31%的总质押 ETH。根据 DeFi Llama 的数据，截至 2024 年 1 月 10 日，stETH 的市值为`**226.24 亿美元**`，占整个市场市值的约 15%！与此同时，第二大流动质押提供商 Rocket Pool，其代币 rETH 的 TVL 为`**29.62 亿美元**`，几乎少了 11 倍！

协议的第一个版本成功运行，将用户资金放置在 Beacon Chain 的经典存款合约中。然而，它不支持质押资金的提取，这一功能预计将在**合并**后推出。因此，开发人员开始致力于协议的第二个版本，旨在引入提取支持。

经过广泛的开发、测试和 Lido 第二版的发布，协议基本上成为了所有类型质押平台的完整替代方案，支持任何规模存款和提取的奖励！这一成就使治理代币 LDO 在 2024 年 1 月 10 日达到了 CoinMarketCap 加密货币排名的第 25 位。

Lido DAO Token (LDO) 是用于管理 Lido 的 ERC-20 标准代币。最大供应量为十亿美元。质押服务的创始人获得了指定数量的 64%。总共有超过 8.9 亿 LDO 在流通中。

# 架构概览

> 让我们探索 Lido 架构的组成部分！我们的目标是了解其组成部分以及当用户与协议交互时会发生什么。

理解协议的架构并不简单，所以在深入了解每个元素的细节之前，我们将从一个简短的介绍性概述开始，以理解当用户（Alice）想要使用协议时它们如何交互。

Lido 的架构基于几个关键元素，每个元素在整个系统中执行至关重要的功能。我们根据其功能将这些元素分为 5 个主要组。请注意，这不是架构的示意图，而是将现有模块按逻辑部分进行图形化组织，以便于理解。

![img](https://img.learnblockchain.cn/attachments/migrate/1719323916548)

Lido 协议架构组件的概括图

# 存款与质押

该组件负责 Lido 生态系统中的初始步骤——存款和质押。用户将其 ETH 转移到 Lido 协议，返还 stETH，代表其在质押池中的份额。此过程允许用户参与 Ethereum 2.0 而无需管理自己的验证者。

# Oracle 基础设施

Oracles 在更新和反映系统中质押资产的当前状态方面起着关键作用。该组件确保 stETH 价值的定期更新，以符合 Ethereum 2.0 中的实际质押收入。Oracles 在监控网络状态和从验证者的共识节点传输链下信息以供链上智能合约使用方面也至关重要。

# 共识

共识在存款和提取过程中起着至关重要的作用，因为它决定了验证者必须遵循的顺序和规则以获得奖励。研究它将帮助我们了解协议操作中可能出现的问题，应该避免的验证者行为场景，以及提取应按什么顺序进行。

自从过渡到 Ethereum 2.0 以来，共识架构发生了许多变化，其中大部分与 Beacon Chain 有关。我们将告诉你哪些变化对 Lido 架构有最显著的影响。

# 提取机制

在引入从 Beacon Chain 退出验证者的能力后，这一极其重要的架构元素立即变得需求旺盛。这是 Lido 开发人员在协议第二版中最为关注的元素，也是大多数创新所在。

感谢这个模块，用户不仅有机会一次性质押其资金，还可以将其提取回来并获得奖励。

# 治理

通过 Aragon DAO 的技术解决方案，确保了 Lido 协议的去中心化和透明管理。这保证了从技术角度的简单维护以及管理协议关键方面的公平机制。

# 与 Lido 的交互

> 了解了架构的主要元素后，让我们看看当 Alice 想要在 Lido 协议中质押 1 ETH 时，底层发生了什么。

# 存款

![img](https://miro.medium.com/v2/resize:fit:1400/1*hJB5CFAzZU2J2bRySQ9_2Q.png)

简化的存款和质押接受方案

- 假设**Alice**想要质押她的 1 ETH。
- **Lido 核心**中的第一步是存款初始化。在调用相关函数后，1 ETH 将从 Alice 的钱包中扣除，作为回报，她将收到 1 stETH。代币将被转移到 Lido 合约地址。
- 接下来，Alice 的资金以及其他存款人的资金（在我们的例子中是 Bob 和 Tom）开始在负责将新存款放置在**Beacon 链**的部分中累积。这个部分被称为**存款与质押基础设施**。这些资金也可以用于支付决定最终存款并提取资金的用户的奖励。
- 想象一下，除了 Alice，**Bob**（15 ETH）和**Tom**（16 ETH）也进行了存款。现在 Lido 已经积累了足够的 ETH 来创建一个质押（需要 32 ETH 的倍数）——协议可以在 Beacon 链中进行存款并开始从存款金额中赚取收益。
- 为此，**存款与质押基础设施**从**节点运营商**那里接收有关新验证者的信息——他们的公钥、签名、提取地址以及将进行存款的协议模块。
- 一旦收集到所有数据，一组验证者会验证这些信息并签署它，以保护 Lido 免受抢先交易的可能性。在收到所有必要的签名后，合约会检查传输数据的正确性。
- 然后，Lido 进行最终的密钥正确性检查，等待存款过程完成，用户的资金最终开始参与质押并获得奖励！> 但是如果 Alice 想要提取她的资金会发生什么？

# 提取

![img](https://img.learnblockchain.cn/attachments/migrate/1719323916555)

提取资金和接收奖励的简化方案

- 为了提取她的资金，Alice 只需提交一个提取请求并等待其完成。完成后，未质押的 1 ETH + 奖励将被转移到 Alice 的地址，1 stETH 将返回到 Lido 的余额中，然后将被销毁。
- 在核心内部，所有提取请求都会被编译成一个提取队列，然后在我们的图表中标记为红色的提取基础设施中处理。
- 一旦 Ejector Oracle 从图中显示的所有系统元素接收到必要的信息，它将执行弹出操作并将未质押的资金返回到提取基础设施。
- 资金返回到 Lido 的合约后，每个提取者的奖励将被计算并随后支付。

# 结论

> 因此，我们简要回顾了协议的历史，并在高层次上审查了用户存入或提取 ETH 时会发生什么。

在后续文章中，我们将详细探讨此过程中涉及的每个模块，并探索提取程序，以便你可以找到问题的答案并欣赏这个卓越协议的深度和创新性。本系列还将作为实用指南，使你更容易处理应用和研究任务。

我们的主要重点将是了解 Lido 的共识机制，这将在我们系列的下一篇文章中介绍。

# 参考文献

# 术语

**[1] — 协议 APR**

我们所说的协议 APR 是指总年百分比率——Lido 验证者收到的整体共识层 (CL) 和执行层 (EL) 奖励与总池化 ETH 的比率，估算为过去 7 天的移动平均值。

**[2] — Lido 验证者的性能**

操作员的主要参数调整得越好，底层协议就越可靠、弹性和高效。

**[3] — 协议费用**

Lido 对质押奖励收取 10% 的费用，这些费用在节点操作员和 DAO 财库之间分配。费用可以通过 DAO 成功投票后进行更改。

# 资源

[4](https://medium.com/predict/what-is-lido-87a4fc23fc4d) — *“什么是 Lido？” — Sunflower Corporation 的文章。*

[5](https://medium.com/hashed-official/a-dive-into-eth-liquid-staking-node-operators-shanghai-future-innovations-and-dvt-523e275a467c) — *“深入了解 ETH 流动质押、节点操作员、上海、未来创新和 DVT”。*

[6](https://docs.lido.fi/) — *Lido 文档*。

[7](https://github.com/lidofinance/lido-dao) — *Lido-dao Github*。

[8](https://aragon.org/education-portal) — *Aragon DAO 教育门户*。

> 本文由 AI 翻译，欢迎小伙伴们来[校对](https://github.com/lbc-team/Pioneer/blob/master/translations/8493.md)。