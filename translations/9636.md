
>- 原文链接：https://extremelysunnyyk.medium.com/borsh-and-its-role-in-anchor-for-solana-48c19308328f
>- 译者：[AI翻译官](https://learnblockchain.cn/people/19584)，校对：[翻译小组](https://learnblockchain.cn/people/412)
>- 本文永久链接：[learnblockchain.cn/article…](https://learnblockchain.cn/article/9636)
    
# Borsh 全面指南 以及 它在 Solana Anchor 的角色

![](https://img.learnblockchain.cn/attachments/migrate/1729590559656)

borsh 很快

## 介绍

在快速发展的区块链技术领域，高效且可靠的数据定序对于性能、可扩展性和安全性至关重要。在 Solana 生态系统中——一个为去中心化应用设计的高性能区块链——**Borsh**（用于哈希的二进制对象表示定序器）已成为首选的定序框架。

与 **Anchor** 搭配使用，这是一种简化 Solana 程序开发的框架，Borsh 使开发人员能够轻松构建强大且高效的去中心化应用程序（dApps）。

本综合指南深入探讨了 Borsh 是什么，为什么它对 Solana 至关重要，它如何与 Anchor 集成，以及它与其他定序框架的不同之处。我们还将探讨接口定义语言（IDL）在促进链上程序与链下客户端之间无缝交互中的作用。

## 什么是定序以及它对区块链的重要性？

定序是将数据结构或对象转换为可以存储或传输的格式，然后再重建的过程。在区块链开发的背景下，尤其是在 **Solana** 上，定序至关重要，因为：

1. **数据必须在网络上传输**（在客户端、节点和智能合约之间）。
2. **存储是有限且昂贵的**，因此数据的紧凑表示是必不可少的。

## 什么是 Borsh？

**Borsh** 代表 **用于哈希的二进制对象表示定序器**。它是一个专为高性能和高效存储而设计的二进制定序框架，特别是在区块链环境中。

Borsh 使复杂数据在链上程序（智能合约）和客户端应用程序之间的定序（将数据结构转换为可存储或传输的格式）和反定序（从定序格式重建数据结构）成为可能。

## Borsh 的关键特性

* **确定性定序**：确保相同数据结构的一致定序输出，这对于加密操作至关重要。
* **紧凑的二进制格式**：与基于文本的格式相比，生成更小的数据负载，优化存储和带宽。
* **高性能**：在定序和反定序过程中进行了速度优化，对于像 Solana 这样的高吞吐量系统至关重要。
* **无模式灵活性**：不需要严格的预定义模式，允许数据结构更容易演变。

## Borsh 与其他定序框架的不同之处

了解 Borsh 与其他定序框架的不同之处，突显了其在区块链应用中的优势。

![](https://img.learnblockchain.cn/attachments/migrate/1729590559663)

定序框架比较表

## 关键见解：

* **Borsh** 针对区块链应用进行了优化，提供确定性、高效和紧凑的定序，无需预定义模式。
* **JSON** 可读性强，但由于其基于文本的性质，数据量较大且性能较慢。
* **Protobuf** 提供高性能和确定性定序，但需要严格的预定义模式，增加了复杂性。
* **MessagePack** 像 Borsh 一样高效，但不保证确定性定序，使其不太适合区块链共识机制。

## 为什么选择 Solana 的 Borsh？

定序可以加快数据处理速度，因为它减少了需要传输或存储的数据量。在 Solana 中，重点是高吞吐量和低延迟，因此优化的定序格式有助于网络更高效地处理交易。

![](https://img.learnblockchain.cn/attachments/migrate/1729590559672)

## 为什么选择 Solana 的 Borsh？

**TLDR**：Solana 使用 **Borsh** 进行定序，而不是更熟悉的格式如 **JSON**。Borsh 专为性能而设计。它生成更紧凑的二进制数据，这：

* **减少了传输或存储的数据量**，节省了带宽和存储成本。
* **提高了编码/解码速度**，与更冗长的格式如 JSON 相比

### 1. 确定性定序

在区块链网络中，确定性行为对于维护所有节点之间的共识至关重要。**Borsh 保证相同的数据结构将始终生成相同的定序输出**。这种一致性对于：

* **加密操作**：哈希和签名需要精确的数据表示。任何变化都可能使签名或哈希无效。
* **状态一致性**：确保网络中的所有验证者在处理交易后可以独立达到相同的状态。

### 2. 紧凑的二进制格式

在区块链上存储或传输的每个字节都可能产生成本。**Borsh 的二进制格式减少了数据大小**，这：

* **降低交易费用**：较小的负载意味着交易中包含的数据更少，从而降低成本。
* **提高网络效率**：减少带宽使用，加快数据在网络中的传播。

### 3. 高性能

Solana 设计用于**高吞吐量和低延迟**，能够处理每秒数千笔交易。Borsh 的性能优化有助于：

* **防止瓶颈**：快速的定序/反定序防止程序成为性能瓶颈。
* **支持可扩展性**：支持处理大量数据而不影响速度。

### 4. 无模式灵活性

与需要预定义模式的定序框架（如 Protocol Buffers）不同，**Borsh 允许灵活的数据结构**：

* **升级的便利性**：开发人员可以在不破坏兼容性的情况下演变数据结构。
* **简化开发**：减少了在不同组件之间维护和同步模式的开销。

## Anchor 和 Borsh 如何协同工作

**Anchor** 是一个简化 Solana 智能合约开发的框架，提供：

* **声明性宏**：简化指令和账户的定义。
* **自动代码生成**：自动生成客户端代码和 IDL。

### 集成工作流程

![](https://img.learnblockchain.cn/attachments/migrate/1729590559677)

Borsh 在 Solana 应用中的作用

**程序定义**：开发人员使用 Rust 编写 Solana 程序，并使用 Anchor 宏注释数据结构。

1. **IDL 生成**：Anchor 处理这些注释以生成一个 **接口定义语言（IDL）** 文件，这是程序接口的 JSON 表示。
2. **使用 Borsh 进行定序**：

* **客户端**：当客户端应用程序与 Solana 程序交互时，它使用 IDL 来理解所需的数据结构，并使用 Borsh 定序指令数据。
* **链上**：Solana 程序接收定序数据，并使用 Borsh 将其反定序回原始数据结构。

### 接口定义语言（IDL）的角色

**IDL** 作为客户端和程序之间的契约：

* **定义数据结构**：指定指令和账户的类型和字段。
* **确保一致性**：客户端和程序使用相同的定义，防止不一致。
* **促进自动化**：客户端库可以基于 IDL 自动生成代码，减少手动编码和潜在错误。

## 示例工作流程

![](https://img.learnblockchain.cn/attachments/migrate/1729590559674)

考虑一个在 Solana 上递增计数器的程序：

1.  **定义指令**：

#\[derive(Accounts)\]  
pub struct Increment<'info\> {  
    #\[account(mut)\]  
    pub counter: Account<'info, Counter>,  
}

**2\. 生成 IDL**：  
Anchor 处理此定义并将其包含在 IDL 中，指定 `Increment` 指令的结构。

**3\. 客户端交互**：

*   客户端使用 IDL 通过 Borsh 定序 `Increment` 指令。
*   在交易中将定序的数据发送到 Solana 网络。

**4\. 程序执行**：

*   Solana 程序使用 Borsh 反定序数据。
*   执行指令，递增计数器。

## 结论

**Borsh** 是一个专门的定序框架，解决了区块链环境中的独特挑战：

*   **效率**：其二进制格式和性能优化减少了开销。
*   **确定性**：确保一致的数据表示，这对安全性和共识至关重要。
*   **灵活性**：无模式设计简化了智能合约的开发和演进。

当与 **Anchor** 和 **IDL** 集成时，Borsh 为在 Solana 上构建可扩展和安全的应用程序提供了坚实的基础。通过确保一致和高效的数据定序，开发人员可以专注于创新，而无需担心底层的定序机制。

![](https://miro.medium.com/v2/resize:fit:1126/0*lPewCaExQmMeaW8C.jpg)

我真是太喜欢 Borsh 了

> 我是 [AI 翻译官](https://learnblockchain.cn/people/19584)，为大家转译优秀英文文章，如有翻译不通的地方，在[这里](https://github.com/lbc-team/Pioneer/blob/master/translations/9636.md)修改，还请包涵～